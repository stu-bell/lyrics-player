<!DOCTYPE html>
<html>
<head>
    <title>Song Lyrics App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
        }
        
        .previous-line,
        .current-line,
        .next-lines {
            font-size: 16px;
            opacity: 0.6;
        }
        
        .current-line {
            font-size: 24px;
            font-weight: bold;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="lyricsContainer">
        <p id="previousLine" class="previous-line"></p>
        <p id="currentLine" class="current-line"></p>
        <p id="nextLines" class="next-lines"></p>
    </div>

    <input type="file" id="fileInput" accept=".txt">
    
    <script>
        let currentLineIndex = 0;
        let lines = [];
        const previousLineElement = document.getElementById('previousLine');
        const currentLineElement = document.getElementById('currentLine');
        const nextLinesElement = document.getElementById('nextLines');
        const fileInput = document.getElementById('fileInput');
        const lyricsContainer = document.getElementById('lyricsContainer');

        function loadLyricsFromFile(file) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const fileContents = event.target.result;
                lines = fileContents.split('\n');
                currentLineIndex = 0;
                updateLyrics();
                fileInput.classList.add('hidden');
            };
            reader.onerror = function(event) {
                console.error('Error reading file:', event.target.error);
            };
            reader.readAsText(file);
        }

        function updateLyrics() {
            previousLineElement.innerText = lines[currentLineIndex - 1] || '';
            currentLineElement.innerText = lines[currentLineIndex];
            nextLinesElement.innerText = lines.slice(currentLineIndex + 1, currentLineIndex + 6).join('\n');
        }

        function scrollNextLine() {
            currentLineIndex++;
            updateLyrics();
        }

        function scrollPreviousLine() {
            currentLineIndex--;
            updateLyrics();
        }

        function handleFileInputChange(event) {
            const file = event.target.files[0];
            if (file) {
                loadLyricsFromFile(file);
            }
        }

        document.getElementById('fileInput').addEventListener('change', handleFileInputChange);

        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space') {
                scrollNextLine();
            } else if (event.code === 'ArrowUp') {
                scrollPreviousLine();
            } else if (event.code === 'ArrowDown') {
                scrollNextLine();
            }
        });

        document.addEventListener('touchstart', function() {
            scrollNextLine();
        });

        // Check compatibility with required APIs
        if (!window.FileReader || !window.FileList || !window.File || !window.Blob) {
            alert('Your browser does not support the required APIs. Please use a modern browser.');
        }
    </script>
</body>
</html>